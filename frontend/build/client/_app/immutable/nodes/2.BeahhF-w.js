import{f as D,a as M}from"../chunks/BL7B2s9I.js";import{i as Ce}from"../chunks/CKi57NbV.js";import{o as Ie}from"../chunks/BJgUTw8A.js";import{c as Y,h as w,L as pe,i as Z,a as Me,b as me,z as _,am as De,r as Oe,H as He,s as ve,d as G,k as J,X as Ee,ak as Le,a2 as ue,e as P,j as le,l as Re,ai as oe,an as Fe,S as ce,ao as z,ap as ze,aq as Pe,ar as Ue,as as R,f as ye,p as be,at as ae,ae as se,ah as Ve,g as qe,au as Be,W as Je,av as We,aw as Ye,ax as Ge,ay as Ke,az as Xe,t as Qe,U as Ze,aA as $e,D as je,G as ea,aB as aa,K as S,I as C,a3 as ra,J as T,aC as b,aD as ta,v as la,aE as sa,F as X}from"../chunks/CwXWRgzM.js";import{e as de,s as B}from"../chunks/iwWP6nog.js";import{i as Q}from"../chunks/DP_-XnFu.js";function na(e,a){return a}function oa(e,a,t){for(var f=[],i=a.length,l,o=a.length,s=0;s<i;s++){let d=a[s];be(d,()=>{if(l){if(l.pending.delete(d),l.done.add(d),l.pending.size===0){var m=e.outrogroups;ne(oe(l.done)),m.delete(l),m.size===0&&(e.outrogroups=null)}}else o-=1},!1)}if(o===0){var v=f.length===0&&t!==null;if(v){var n=t,c=n.parentNode;Ve(c),c.append(n),e.items.clear()}ne(a,!v)}else l={pending:new Set(a),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(l)}function ne(e,a=!0){for(var t=0;t<e.length;t++)qe(e[t],a)}var he;function ia(e,a,t,f,i,l=null){var o=e,s=new Map;{var v=e;o=w?Y(pe(v)):v.appendChild(Z())}w&&Me();var n=null,c=De(()=>{var g=t();return Fe(g)?g:g==null?[]:oe(g)}),d,m=!0;function F(){E.fallback=n,fa(E,d,o,a,f),n!==null&&(d.length===0?(n.f&R)===0?ye(n):(n.f^=R,W(n,null,o)):be(n,()=>{n=null}))}var r=me(()=>{d=_(c);var g=d.length;let A=!1;if(w){var y=Oe(o)===He;y!==(g===0)&&(o=ve(),Y(o),G(!1),A=!0)}for(var O=new Set,x=P,I=Re(),N=0;N<g;N+=1){w&&J.nodeType===Ee&&J.data===Le&&(o=J,A=!0,G(!1));var H=d[N],k=f(H,N),h=m?null:s.get(k);h?(h.v&&ue(h.v,H),h.i&&ue(h.i,N),I&&x.skipped_effects.delete(h.e)):(h=va(s,m?o:he??(he=Z()),H,k,N,i,a,t),m||(h.e.f|=R),s.set(k,h)),O.add(k)}if(g===0&&l&&!n&&(m?n=le(()=>l(o)):(n=le(()=>l(he??(he=Z()))),n.f|=R)),w&&g>0&&Y(ve()),!m)if(I){for(const[U,K]of s)O.has(U)||x.skipped_effects.add(K.e);x.oncommit(F),x.ondiscard(()=>{})}else F();A&&G(!0),_(c)}),E={effect:r,items:s,outrogroups:null,fallback:n};m=!1,w&&(o=J)}function fa(e,a,t,f,i){var k;var l=a.length,o=e.items,s=e.effect.first,v,n=null,c=[],d=[],m,F,r,E;for(E=0;E<l;E+=1){if(m=a[E],F=i(m,E),r=o.get(F).e,e.outrogroups!==null)for(const h of e.outrogroups)h.pending.delete(r),h.done.delete(r);if((r.f&R)!==0)if(r.f^=R,r===s)W(r,null,t);else{var g=n?n.next:s;r===e.effect.last&&(e.effect.last=r.prev),r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),L(e,n,r),L(e,r,g),W(r,g,t),n=r,c=[],d=[],s=n.next;continue}if((r.f&ae)!==0&&ye(r),r!==s){if(v!==void 0&&v.has(r)){if(c.length<d.length){var A=d[0],y;n=A.prev;var O=c[0],x=c[c.length-1];for(y=0;y<c.length;y+=1)W(c[y],A,t);for(y=0;y<d.length;y+=1)v.delete(d[y]);L(e,O.prev,x.next),L(e,n,O),L(e,x,A),s=A,n=x,E-=1,c=[],d=[]}else v.delete(r),W(r,s,t),L(e,r.prev,r.next),L(e,r,n===null?e.effect.first:n.next),L(e,n,r),n=r;continue}for(c=[],d=[];s!==null&&s!==r;)(v??(v=new Set)).add(s),d.push(s),s=s.next;if(s===null)continue}(r.f&R)===0&&c.push(r),n=r,s=r.next}if(e.outrogroups!==null){for(const h of e.outrogroups)h.pending.size===0&&(ne(oe(h.done)),(k=e.outrogroups)==null||k.delete(h));e.outrogroups.size===0&&(e.outrogroups=null)}if(s!==null||v!==void 0){var I=[];if(v!==void 0)for(r of v)(r.f&ae)===0&&I.push(r);for(;s!==null;)(s.f&ae)===0&&s!==e.fallback&&I.push(s),s=s.next;var N=I.length;if(N>0){var H=l===0?t:null;oa(e,I,H)}}}function va(e,a,t,f,i,l,o,s){var v=(o&Pe)!==0?(o&Ue)===0?z(t,!1,!1):ce(t):null,n=(o&ze)!==0?ce(i):null;return{v,i:n,e:le(()=>(l(a,v??t,n??i,s),()=>{e.delete(f)}))}}function W(e,a,t){if(e.nodes)for(var f=e.nodes.start,i=e.nodes.end,l=a&&(a.f&R)===0?a.nodes.start:t;f!==null;){var o=se(f);if(l.before(f),f===i)return;f=o}}function L(e,a,t){a===null?e.effect.first=t:a.next=t,t===null?e.effect.last=a:t.prev=a}function ua(e,a){let t=null,f=w;var i;if(w){t=J;for(var l=pe(document.head);l!==null&&(l.nodeType!==Ee||l.data!==e);)l=se(l);if(l===null)G(!1);else{var o=se(l);l.remove(),Y(o)}}w||(i=document.head.appendChild(Z()));try{me(()=>a(i),Be)}finally{f&&(G(!0),Y(t))}}const ca=Symbol("is custom element"),da=Symbol("is html");function ha(e){if(w){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var f=e.value;_e(e,"value",null),e.value=f}if(e.hasAttribute("checked")){var i=e.checked;_e(e,"checked",null),e.checked=i}}};e.__on_r=t,Je(t),We()}}function _e(e,a,t,f){var i=_a(e);w&&(i[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||i[a]!==(i[a]=t)&&(a==="loading"&&(e[Ye]=t),e.removeAttribute(a))}function _a(e){return e.__attributes??(e.__attributes={[ca]:e.nodeName.includes("-"),[da]:e.namespaceURI===Ge})}function ge(e,a,t=a){var f=new WeakSet;Ke(e,"input",async i=>{var l=i?e.defaultValue:e.value;if(l=re(e)?te(l):l,t(l),P!==null&&f.add(P),await Xe(),l!==(l=a())){var o=e.selectionStart,s=e.selectionEnd,v=e.value.length;if(e.value=l??"",s!==null){var n=e.value.length;o===s&&s===v&&n>v?(e.selectionStart=n,e.selectionEnd=n):(e.selectionStart=o,e.selectionEnd=Math.min(s,n))}}}),(w&&e.defaultValue!==e.value||Qe(a)==null&&e.value)&&(t(re(e)?te(e.value):e.value),P!==null&&f.add(P)),Ze(()=>{var i=a();if(e===document.activeElement){var l=$e??P;if(f.has(l))return}re(e)&&i===te(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function re(e){var a=e.type;return a==="number"||a==="range"}function te(e){return e===""?null:+e}const ie="http://localhost:3000";async function ga(){const e=await fetch(`${ie}/api/health`);if(!e.ok)throw new Error("Health check failed");return e.json()}async function pa(){const e=await fetch(`${ie}/api/notes`);if(!e.ok)throw new Error("Failed to load notes");return e.json()}async function ma(e,a){const t=await fetch(`${ie}/api/notes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,body:a})}),f=await t.json();if(!t.ok)throw new Error((f==null?void 0:f.error)||"Failed to create note");return f}var Ea=D("<p>Loading…</p>"),ya=D('<div class="error svelte-1uha8ag"> </div>'),ba=D('<pre class="svelte-1uha8ag"> </pre>'),wa=D("<p>Health unavailable.</p>"),ka=D("<p>No notes yet.</p>"),Sa=D('<li class="svelte-1uha8ag"><div class="note-title svelte-1uha8ag"> </div> <div class="note-body svelte-1uha8ag"> </div> <div class="note-meta svelte-1uha8ag"> </div></li>'),Ta=D('<ul class="svelte-1uha8ag"></ul>'),Aa=D('<!> <section class="card svelte-1uha8ag"><h2>Service health</h2> <!> <button class="svelte-1uha8ag">Refresh</button></section> <section class="card svelte-1uha8ag"><h2>Deployment notes</h2> <div class="form svelte-1uha8ag"><input placeholder="Title" maxlength="80" class="svelte-1uha8ag"/> <textarea placeholder="What changed?" maxlength="500" class="svelte-1uha8ag"></textarea> <button class="svelte-1uha8ag">Add note</button></div> <!></section>',1),xa=D('<main class="container svelte-1uha8ag"><h1>DevOps Pulse</h1> <p class="subtitle svelte-1uha8ag">A tiny app to demonstrate CI/CD, health checks and automated testing.</p> <!> <footer class="svelte-1uha8ag"><small>Tip: demo pipeline: lint → tests → build containers → deploy → smoke test.</small></footer></main>');function Ha(e,a){je(a,!1);let t=z(null),f=z([]),i=z(""),l=z(""),o=z(""),s=z(!0);async function v(){b(s,!0),b(o,"");try{b(t,await ga()),b(f,await pa())}catch(r){b(o,r.message)}finally{b(s,!1)}}async function n(){b(o,"");try{await ma(_(i),_(l)),b(i,""),b(l,""),await v()}catch(r){b(o,r.message)}}Ie(v),Ce();var c=xa();ua("1uha8ag",r=>{aa(()=>{ta.title="DevOps Pulse"})});var d=S(C(c),4);{var m=r=>{var E=Ea();M(r,E)},F=r=>{var E=Aa(),g=la(E);{var A=u=>{var p=ya(),V=C(p,!0);T(p),X(()=>B(V,_(o))),M(u,p)};Q(g,u=>{_(o)&&u(A)})}var y=S(g,2),O=S(C(y),2);{var x=u=>{var p=ba(),V=C(p,!0);T(p),X(q=>B(V,q),[()=>JSON.stringify(_(t),null,2)]),M(u,p)},I=u=>{var p=wa();M(u,p)};Q(O,u=>{_(t)?u(x):u(I,!1)})}var N=S(O,2);T(y);var H=S(y,2),k=S(C(H),2),h=C(k);ha(h);var U=S(h,2);sa(U);var K=S(U,2);T(k);var we=S(k,2);{var ke=u=>{var p=ka();M(u,p)},Se=u=>{var p=Ta();ia(p,5,()=>_(f),na,(V,q)=>{var $=Sa(),j=C($),Te=C(j,!0);T(j);var ee=S(j,2),Ae=C(ee,!0);T(ee);var fe=S(ee,2),xe=C(fe,!0);T(fe),T($),X(Ne=>{B(Te,_(q).title),B(Ae,_(q).body),B(xe,Ne)},[()=>new Date(_(q).createdAt).toLocaleString()]),M(V,$)}),T(p),M(u,p)};Q(we,u=>{_(f).length===0?u(ke):u(Se,!1)})}T(H),X(()=>K.disabled=!_(i)||!_(l)),de("click",N,v),ge(h,()=>_(i),u=>b(i,u)),ge(U,()=>_(l),u=>b(l,u)),de("click",K,n),M(r,E)};Q(d,r=>{_(s)?r(m):r(F,!1)})}ra(2),T(c),M(e,c),ea()}export{Ha as component};
